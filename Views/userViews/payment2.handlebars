<style>
    /* Cải tiến giao diện tổng thể */
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f8f9fa;
        padding: 20px;
    }

    .container {
        max-width: 1200px;
        margin: auto;
    }

    /* Order Header */
    .order-header {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background-color: #ffffff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .order-header h5 {
        font-size: 20px;
        font-weight: 600;
    }

    .status {
        color: #fff;
        background-color: #f0ad4e;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 14px;
    }

    .btn-copy {
        cursor: pointer;
        background: none;
        border: none;
        color: #007bff;
        text-decoration: underline;
    }

    .table td,
    .table th {
        vertical-align: middle;
    }

    /* Cải tiến Payment Information */
    .payment-info {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background-color: #ffffff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-top: 30px;
    }

    .payment-info h5 {
        font-size: 20px;
        font-weight: 600;
    }

    .payment-info table td {
        font-size: 14px;
    }

    .payment-info table td strong {
        color: #007bff;
    }

    /* Style cho thông báo */
    #notification {
        position: fixed;
        top: -100px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #4CAF50;
        color: white;
        padding: 15px 30px;
        border-radius: 5px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: top 0.5s ease-out;
        z-index: 1000;
        font-size: 16px;
    }

    #notification.show {
        top: 20px;
    }

    .hidden {
        display: none;
    }

    img.img-fluid {
        max-width: 180px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }

    /* Nút thanh toán */
    .btn-rectangle {
        background-color: #007bff;
        border: none;
        padding: 8px 16px;
        color: #fff;
        border-radius: 5px;
        cursor: pointer;
    }

    .btn-rectangle:hover {
        background-color: #0056b3;
        transition: background-color 0.3s ease;
    }

    /* Style cho bảng */
    .table {
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .table-bordered {
        border: 1px solid #ddd;
    }

    .table-light {
        background-color: #f7f7f7;
    }

    /* Thiết kế giao diện cho thanh sao chép */
    .btn-copy {
        cursor: pointer;
        background: none;
        border: none;
        color: #007bff;
        font-weight: 600;
    }

    .btn-copy:hover {
        text-decoration: underline;
        transition: text-decoration 0.3s;
    }
</style>

<div id="notification" class="hidden">
    <p>Thanh toán thành công!</p>
</div>

<div class="container mt-5">
    <!-- Order Header -->
    <div class="order-header">
        <h5>ĐƠN HÀNG</h5>
        <div class="row">
            <div class="col-md-4">
                <strong>Mã đơn #:</strong>
                <span>{{paymentInfo.booking_id}}</span>
            </div>
            <div class="col-md-4">
                <strong>Số tiền:</strong>
                <span id="amount">₫0</span>
            </div>
            <div class="col-md-4">
                <strong>TT hóa đơn:</strong>
                <span class="status" id="paymentStatus">Chưa thanh toán</span>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-6">
                <strong>Ngày tạo:</strong>
                <span>{{dateTime}}</span>
            </div>
        </div>
    </div>

    <!-- Product Information -->
    <div class="order-header">
        <h5>Thông tin sản phẩm</h5>
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>Tên sản phẩm</th>
                    <th>Số lượng</th>
                    <th>Trạng thái</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{detail.title}}</td>
                    <td>{{numbers}}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Payment Information -->
    <div class="payment-info">
        <h5>THÔNG TIN THANH TOÁN</h5>
        <table class="table table-bordered">
            <tbody>
                <tr>
                    <td><strong>Ngân hàng:</strong></td>
                    <td>Chuyển khoản ngân hàng</td>
                </tr>
                <tr>
                    <td><strong>Số tài khoản:</strong></td>
                    <td>
                        {{bankAccount}}
                        <button class="btn-rectangle" onclick="copyToClipboard('{{bankAccount}}')">Sao chép</button>
                    </td>
                </tr>
                <tr>
                    <td><strong>Tên tài khoản:</strong></td>
                    <td>NGUYEN HAI QUAN / VIETCOMBANK</td>
                </tr>
                <tr>
                    <td><strong>Số tiền:</strong></td>
                    <td>{{paymentInfo.amount}}</td>
                </tr>
                <tr>
                    <td><strong>Nội dung thanh toán:</strong></td>
                    <td>Tour: {{tour_id}} {{detail.title}}
                        <button class="btn-rectangle" onclick="copyToClipboard('Tour: {{tour_id}} {{detail.title}}')">Sao chép</button>
                    </td>
                </tr>
                <tr>
                    <td><strong>Mã QR:</strong></td>
                    <td>
                        <img src="/QRpay/QRcode.jpg" alt="QR Code" class="img-fluid">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    // Cập nhật giá trị thanh toán
    function updateSummary() {
        const price = "{{paymentInfo.amount}}";
        document.getElementById('amount').textContent = '₫' + parseFloat(price).toLocaleString('vi-VN');
    }
    document.addEventListener("DOMContentLoaded", updateSummary);

    // Cập nhật trạng thái thanh toán và hiển thị thông báo thành công
    function updatePaymentStatus() {
        const statusElement = document.getElementById('paymentStatus');
        statusElement.textContent = 'Đã thanh toán';
        statusElement.style.backgroundColor = 'green';
        statusElement.style.color = 'white';
    }

    function showNotification() {
        const notification = document.getElementById('notification');
        notification.classList.remove('hidden');
        setTimeout(() => notification.classList.add('show'), 10);
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => notification.classList.add('hidden'), 500);
        }, 3000);
    }

    // Kiểm tra trạng thái thanh toán
    function checkPaymentStatus() {
        const tour_id = "{{tour_id}}";
        fetch(`/status/${tour_id}`)
            .then(response => response.json())
            .then(data => {
                if (data.status === 'confirmed') {
                    updatePaymentStatus();
                    showNotification();
                    setTimeout(() => window.location.href = '/customer', 3500);
                }
            })
            .catch(error => console.error('Lỗi khi kiểm tra trạng thái thanh toán:', error));
    }

    document.addEventListener("DOMContentLoaded", setInterval(checkPaymentStatus, 5000));
</script>

<script>
    function copyToClipboard(text) {
        if (!navigator.clipboard) {
            alert('Trình duyệt của bạn không hỗ trợ Clipboard API.');
            return;
        }

        navigator.clipboard.writeText(text)
            .then(() => alert('Đã sao chép: ' + text))
            .catch((err) => {
                console.error('Lỗi khi sao chép vào clipboard:', err);
                alert('Không thể sao chép vào clipboard. Vui lòng thử lại.');
            });
    }
</script>
